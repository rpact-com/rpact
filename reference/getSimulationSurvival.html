<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Get Simulation Survival — getSimulationSurvival • rpact</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get Simulation Survival — getSimulationSurvival"><meta name="description" content="Returns the analysis times, power, stopping probabilities, conditional power, and expected sample size
for testing the hazard ratio in a two treatment groups survival design."><meta property="og:description" content="Returns the analysis times, power, stopping probabilities, conditional power, and expected sample size
for testing the hazard ratio in a two treatment groups survival design."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rpact</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.0.1.9248</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/rpact_getting_started.html">Getting started with rpact</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rpact-com/rpact/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Get Simulation Survival</h1>
      <small class="dont-index">Source: <a href="https://github.com/rpact-com/rpact/blob/main/R/f_simulation_base_survival.R" class="external-link"><code>R/f_simulation_base_survival.R</code></a></small>
      <div class="d-none name"><code>getSimulationSurvival.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Returns the analysis times, power, stopping probabilities, conditional power, and expected sample size
for testing the hazard ratio in a two treatment groups survival design.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">getSimulationSurvival</span><span class="op">(</span></span>
<span>  design <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  thetaH0 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  directionUpper <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pi1 <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  pi2 <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  lambda1 <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  lambda2 <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  median1 <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  median2 <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  hazardRatio <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  kappa <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  piecewiseSurvivalTime <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  allocation1 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  allocation2 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  eventTime <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  accrualTime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">12</span><span class="op">)</span>,</span>
<span>  accrualIntensity <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  accrualIntensityType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auto"</span>, <span class="st">"absolute"</span>, <span class="st">"relative"</span><span class="op">)</span>,</span>
<span>  dropoutRate1 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  dropoutRate2 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  dropoutTime <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  maxNumberOfSubjects <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  plannedEvents <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  minNumberOfEventsPerStage <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  maxNumberOfEventsPerStage <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  conditionalPower <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  thetaH1 <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  maxNumberOfIterations <span class="op">=</span> <span class="fl">1000L</span>,</span>
<span>  maxNumberOfRawDatasetsPerStage <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  longTimeSimulationAllowed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  calcEventsFunction <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  showStatistics <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-design">design<a class="anchor" aria-label="anchor" href="#arg-design"></a></dt>
<dd><p>The trial design. If no trial design is specified, a fixed sample size design is used.
In this case, Type I error rate <code>alpha</code>, Type II error rate <code>beta</code>, <code>twoSidedPower</code>,
and <code>sided</code> can be directly entered as argument where necessary.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Ensures that all arguments (starting from the "...") are to be named and
that a warning will be displayed if unknown arguments are passed.</p></dd>


<dt id="arg-thetah-">thetaH0<a class="anchor" aria-label="anchor" href="#arg-thetah-"></a></dt>
<dd><p>The null hypothesis value,
default is <code>0</code> for the normal and the binary case (testing means and rates, respectively),
it is <code>1</code> for the survival case (testing the hazard ratio).<br><br>
For non-inferiority designs, <code>thetaH0</code> is the non-inferiority bound.
That is, in case of (one-sided) testing of</p><ul><li><p><em>means</em>: a value <code>!= 0</code>
(or a value <code>!= 1</code> for testing the mean ratio) can be specified.</p></li>
<li><p><em>rates</em>: a value <code>!= 0</code>
(or a value <code>!= 1</code> for testing the risk ratio <code>pi1 / pi2</code>) can be specified.</p></li>
<li><p><em>survival data</em>: a bound for testing H0: <code>hazard ratio = thetaH0 != 1</code> can be specified.</p></li>
<li><p><em>count data</em>: a bound for testing H0: <code>lambda1 / lambda2 = thetaH0 != 1</code> can be specified.</p></li>
</ul><p>For testing a rate in one sample, a value <code>thetaH0</code> in (0, 1) has to be specified for
defining the null hypothesis H0: <code>pi = thetaH0</code>.</p></dd>


<dt id="arg-directionupper">directionUpper<a class="anchor" aria-label="anchor" href="#arg-directionupper"></a></dt>
<dd><p>Logical. Specifies the direction of the alternative,
only applicable for one-sided testing; default is <code>TRUE</code>
which means that larger values of the test statistics yield smaller p-values.</p></dd>


<dt id="arg-pi-">pi1<a class="anchor" aria-label="anchor" href="#arg-pi-"></a></dt>
<dd><p>A numeric value or vector that represents the assumed event rate in the treatment group,
default is <code>seq(0.2, 0.5, 0.1)</code> (power calculations and simulations) or
<code>seq(0.4, 0.6, 0.1)</code> (sample size calculations).</p></dd>


<dt id="arg-pi-">pi2<a class="anchor" aria-label="anchor" href="#arg-pi-"></a></dt>
<dd><p>A numeric value that represents the assumed event rate in the control group, default is <code>0.2</code>.</p></dd>


<dt id="arg-lambda-">lambda1<a class="anchor" aria-label="anchor" href="#arg-lambda-"></a></dt>
<dd><p>The assumed hazard rate in the treatment group, there is no default.
<code>lambda1</code> can also be used to define piecewise exponentially distributed survival times (see details). Must be a positive numeric of length 1.</p></dd>


<dt id="arg-lambda-">lambda2<a class="anchor" aria-label="anchor" href="#arg-lambda-"></a></dt>
<dd><p>The assumed hazard rate in the reference group, there is no default.
<code>lambda2</code> can also be used to define piecewise exponentially distributed survival times (see details). Must be a positive numeric of length 1.</p></dd>


<dt id="arg-median-">median1<a class="anchor" aria-label="anchor" href="#arg-median-"></a></dt>
<dd><p>The assumed median survival time in the treatment group, there is no default.</p></dd>


<dt id="arg-median-">median2<a class="anchor" aria-label="anchor" href="#arg-median-"></a></dt>
<dd><p>The assumed median survival time in the reference group, there is no default. Must be a positive numeric of length 1.</p></dd>


<dt id="arg-hazardratio">hazardRatio<a class="anchor" aria-label="anchor" href="#arg-hazardratio"></a></dt>
<dd><p>The vector of hazard ratios under consideration.
If the event or hazard rates in both treatment groups are defined, the hazard ratio needs
not to be specified as it is calculated, there is no default. Must be a positive numeric of length 1.</p></dd>


<dt id="arg-kappa">kappa<a class="anchor" aria-label="anchor" href="#arg-kappa"></a></dt>
<dd><p>A numeric value &gt; 0. A <code>kappa != 1</code> will be used for the specification
of the shape of the Weibull distribution.
Default is <code>1</code>, i.e., the exponential survival distribution is used instead of the Weibull distribution.
Note that the Weibull distribution cannot be used for the piecewise definition of
the survival time distribution, i.e., only <code>piecewiselambda</code> (as a single value) and <code>kappa</code>
can be specified.
This function is equivalent to <code>pweibull(t, shape = kappa, scale = 1 / lambda)</code>
of the <code>stats</code> package, i.e., the scale parameter is <code>1 / 'hazard rate'</code>.<br>
For example,
<code>getPiecewiseExponentialDistribution(time = 130, piecewiseLambda = 0.01, kappa = 4.2)</code>
and <code>pweibull(q = 130, shape = 4.2, scale = 1 / 0.01)</code> provide the sample result.</p></dd>


<dt id="arg-piecewisesurvivaltime">piecewiseSurvivalTime<a class="anchor" aria-label="anchor" href="#arg-piecewisesurvivaltime"></a></dt>
<dd><p>A vector that specifies the time intervals for the piecewise
definition of the exponential survival time cumulative distribution function <br>
(for details see <code><a href="getPiecewiseSurvivalTime.html">getPiecewiseSurvivalTime()</a></code>).</p></dd>


<dt id="arg-allocation-">allocation1<a class="anchor" aria-label="anchor" href="#arg-allocation-"></a></dt>
<dd><p>The number how many subjects are assigned to treatment 1 in a
subsequent order, default is <code>1</code></p></dd>


<dt id="arg-allocation-">allocation2<a class="anchor" aria-label="anchor" href="#arg-allocation-"></a></dt>
<dd><p>The number how many subjects are assigned to treatment 2 in a
subsequent order, default is <code>1</code></p></dd>


<dt id="arg-eventtime">eventTime<a class="anchor" aria-label="anchor" href="#arg-eventtime"></a></dt>
<dd><p>The assumed time under which the event rates are calculated, default is <code>12</code>.</p></dd>


<dt id="arg-accrualtime">accrualTime<a class="anchor" aria-label="anchor" href="#arg-accrualtime"></a></dt>
<dd><p>The assumed accrual time intervals for the study, default is
<code>c(0, 12)</code> (for details see <code><a href="getAccrualTime.html">getAccrualTime()</a></code>).</p></dd>


<dt id="arg-accrualintensity">accrualIntensity<a class="anchor" aria-label="anchor" href="#arg-accrualintensity"></a></dt>
<dd><p>A numeric vector of accrual intensities, default is the relative
intensity <code>0.1</code> (for details see <code><a href="getAccrualTime.html">getAccrualTime()</a></code>).</p></dd>


<dt id="arg-accrualintensitytype">accrualIntensityType<a class="anchor" aria-label="anchor" href="#arg-accrualintensitytype"></a></dt>
<dd><p>A character value specifying the accrual intensity input type.
Must be one of <code>"auto"</code>, <code>"absolute"</code>, or <code>"relative"</code>; default is <code>"auto"</code>,
i.e., if all values are &lt; 1 the type is <code>"relative"</code>, otherwise it is <code>"absolute"</code>.</p></dd>


<dt id="arg-dropoutrate-">dropoutRate1<a class="anchor" aria-label="anchor" href="#arg-dropoutrate-"></a></dt>
<dd><p>The assumed drop-out rate in the treatment group, default is <code>0</code>.</p></dd>


<dt id="arg-dropoutrate-">dropoutRate2<a class="anchor" aria-label="anchor" href="#arg-dropoutrate-"></a></dt>
<dd><p>The assumed drop-out rate in the control group, default is <code>0</code>.</p></dd>


<dt id="arg-dropouttime">dropoutTime<a class="anchor" aria-label="anchor" href="#arg-dropouttime"></a></dt>
<dd><p>The assumed time for drop-out rates in the control and the
treatment group, default is <code>12</code>.</p></dd>


<dt id="arg-maxnumberofsubjects">maxNumberOfSubjects<a class="anchor" aria-label="anchor" href="#arg-maxnumberofsubjects"></a></dt>
<dd><p><code>maxNumberOfSubjects &gt; 0</code> needs to be specified.
If accrual time and accrual intensity are specified, this will be calculated. Must be a positive integer of length 1.</p></dd>


<dt id="arg-plannedevents">plannedEvents<a class="anchor" aria-label="anchor" href="#arg-plannedevents"></a></dt>
<dd><p><code>plannedEvents</code> is a numeric vector of length <code>kMax</code> (the number of stages of the design)
that determines the number of cumulated (overall) events in survival designs when the interim stages are planned.
For two treatment arms, it is the number of events for both treatment arms.
For multi-arm designs, <code>plannedEvents</code> refers to the overall number of events for the selected arms plus control.</p></dd>


<dt id="arg-minnumberofeventsperstage">minNumberOfEventsPerStage<a class="anchor" aria-label="anchor" href="#arg-minnumberofeventsperstage"></a></dt>
<dd><p>When performing a data driven sample size recalculation,
the numeric vector <code>minNumberOfEventsPerStage</code> with length kMax determines the
minimum number of events per stage (i.e., not cumulated), the first element
is not taken into account.</p></dd>


<dt id="arg-maxnumberofeventsperstage">maxNumberOfEventsPerStage<a class="anchor" aria-label="anchor" href="#arg-maxnumberofeventsperstage"></a></dt>
<dd><p>When performing a data driven sample size recalculation,
the numeric vector <code>maxNumberOfEventsPerStage</code> with length kMax determines the maximum number
of events per stage (i.e., not cumulated), the first element is not taken into account.</p></dd>


<dt id="arg-conditionalpower">conditionalPower<a class="anchor" aria-label="anchor" href="#arg-conditionalpower"></a></dt>
<dd><p>If <code>conditionalPower</code> together with <code>minNumberOfSubjectsPerStage</code> and
<code>maxNumberOfSubjectsPerStage</code> (or <code>minNumberOfEventsPerStage</code> and <code>maxNumberOfEventsPerStage</code>
for survival designs) is specified, a sample size recalculation based on the specified conditional power is performed.
It is defined as the power for the subsequent stage given the current data. By default,
the conditional power will be calculated under the observed effect size. Optionally, you can also specify <code>thetaH1</code> and
<code>stDevH1</code> (for simulating means), <code>pi1H1</code> and <code>pi2H1</code> (for simulating rates), or <code>thetaH1</code> (for simulating
hazard ratios) as parameters under which it is calculated and the sample size recalculation is performed.</p></dd>


<dt id="arg-thetah-">thetaH1<a class="anchor" aria-label="anchor" href="#arg-thetah-"></a></dt>
<dd><p>If specified, the value of the alternative under which
the conditional power or sample size recalculation calculation is performed. Must be a numeric of length 1.</p></dd>


<dt id="arg-maxnumberofiterations">maxNumberOfIterations<a class="anchor" aria-label="anchor" href="#arg-maxnumberofiterations"></a></dt>
<dd><p>The number of simulation iterations, default is <code>1000</code>. Must be a positive integer of length 1.</p></dd>


<dt id="arg-maxnumberofrawdatasetsperstage">maxNumberOfRawDatasetsPerStage<a class="anchor" aria-label="anchor" href="#arg-maxnumberofrawdatasetsperstage"></a></dt>
<dd><p>The number of raw datasets per stage that shall
be extracted and saved as <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></code>, default is <code>0</code>.
<code><a href="getRawData.html">getRawData()</a></code> can be used to get the extracted raw data from the object.</p></dd>


<dt id="arg-longtimesimulationallowed">longTimeSimulationAllowed<a class="anchor" aria-label="anchor" href="#arg-longtimesimulationallowed"></a></dt>
<dd><p>Logical that indicates whether long time simulations
that consumes more than 30 seconds are allowed or not, default is <code>FALSE</code>.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>The seed to reproduce the simulation, default is a random seed.</p></dd>


<dt id="arg-calceventsfunction">calcEventsFunction<a class="anchor" aria-label="anchor" href="#arg-calceventsfunction"></a></dt>
<dd><p>Optionally, a function can be entered that defines the way of performing the sample size
recalculation. By default, event number recalculation is performed with conditional power and specified
<code>minNumberOfEventsPerStage</code> and <code>maxNumberOfEventsPerStage</code> (see details and examples).</p></dd>


<dt id="arg-showstatistics">showStatistics<a class="anchor" aria-label="anchor" href="#arg-showstatistics"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, summary statistics of the simulated data
are displayed for the <code>print</code> command, otherwise the output is suppressed, default
is <code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a <code><a href="SimulationResults.html">SimulationResults</a></code> object.
The following generics (R generic functions) are available for this object:</p><ul><li><p><code><a href="names.FieldSet.html">names()</a></code> to obtain the field names,</p></li>
<li><p><code><a href="print.FieldSet.html">print()</a></code> to print the object,</p></li>
<li><p><code><a href="summary.ParameterSet.html">summary()</a></code> to display a summary of the object,</p></li>
<li><p><code><a href="plot.SimulationResults.html">plot()</a></code> to plot the object,</p></li>
<li><p><code><a href="as.data.frame.ParameterSet.html">as.data.frame()</a></code> to coerce the object to a <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></code>,</p></li>
<li><p><code><a href="as.matrix.FieldSet.html">as.matrix()</a></code> to coerce the object to a <code><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>At given design the function simulates the power, stopping probabilities, conditional power, and expected
sample size at given number of events, number of subjects, and parameter configuration.
It also simulates the time when the required events are expected under the given
assumptions (exponentially, piecewise exponentially, or Weibull distributed survival times
and constant or non-constant piecewise accrual).
Additionally, integers <code>allocation1</code> and <code>allocation2</code> can be specified that determine the number allocated
to treatment group 1 and treatment group 2, respectively.
More precisely, unequal randomization ratios must be specified via the two integer arguments <code>allocation1</code> and
<code>allocation2</code> which describe how many subjects are consecutively enrolled in each group, respectively, before a
subject is assigned to the other group. For example, the arguments <code>allocation1 = 2</code>, <code>allocation2 = 1</code>,
<code>maxNumberOfSubjects = 300</code> specify 2:1 randomization with 200 subjects randomized to intervention and 100 to
control. (Caveat: Do not use <code>allocation1 = 200</code>, <code>allocation2 = 100</code>, <code>maxNumberOfSubjects = 300</code>
as this would imply that the 200 intervention subjects are enrolled prior to enrollment of any control subjects.)</p>
<p><code>conditionalPower</code><br>
The definition of <code>thetaH1</code> makes only sense if <code>kMax</code> &gt; 1
and if <code>conditionalPower</code>, <code>minNumberOfEventsPerStage</code>, and
<code>maxNumberOfEventsPerStage</code> are defined.</p>
<p>Note that <code>numberOfSubjects</code>, <code>numberOfSubjects1</code>, and <code>numberOfSubjects2</code> in the output
are the expected number of subjects.</p>
<p><code>calcEventsFunction</code><br>
This function returns the number of events at given conditional power and conditional critical value for specified
testing situation. The function might depend on variables
<code>stage</code>,
<code>conditionalPower</code>,
<code>thetaH0</code>,
<code>plannedEvents</code>,
<code>singleEventsPerStage</code>,
<code>minNumberOfEventsPerStage</code>,
<code>maxNumberOfEventsPerStage</code>,
<code>allocationRatioPlanned</code>,
<code>conditionalCriticalValue</code>,
The function has to contain the three-dots argument '...' (see examples).</p>
    </div>
    <div class="section level2">
    <h2 id="piecewise-survival-time">Piecewise survival time<a class="anchor" aria-label="anchor" href="#piecewise-survival-time"></a></h2>


<p>The first element of the vector <code>piecewiseSurvivalTime</code> must be equal to <code>0</code>.
<code>piecewiseSurvivalTime</code> can also be a list that combines the definition of the
time intervals and hazard rates in the reference group.
The definition of the survival time in the treatment group is obtained by the specification
of the hazard ratio (see examples for details).</p>
    </div>
    <div class="section level2">
    <h2 id="staggered-patient-entry">Staggered patient entry<a class="anchor" aria-label="anchor" href="#staggered-patient-entry"></a></h2>


<p><code>accrualTime</code> is the time period of subjects' accrual in a study.
It can be a value that defines the end of accrual or a vector.
In this case, <code>accrualTime</code> can be used to define a non-constant accrual over time.
For this, <code>accrualTime</code> is a vector that defines the accrual intervals.
The first element of <code>accrualTime</code> must be equal to <code>0</code> and, additionally,
<code>accrualIntensity</code> needs to be specified.
<code>accrualIntensity</code> itself is a value or a vector (depending on the
length of <code>accrualTime</code>) that defines the intensity how subjects
enter the trial in the intervals defined through <code>accrualTime</code>.</p>
<p><code>accrualTime</code> can also be a list that combines the definition of the accrual time and
accrual intensity (see below and examples for details).</p>
<p>If the length of <code>accrualTime</code> and the length of <code>accrualIntensity</code> are the same
(i.e., the end of accrual is undefined), <code>maxNumberOfSubjects &gt; 0</code> needs to be specified
and the end of accrual is calculated.
In that case, <code>accrualIntensity</code> is the number of subjects per time unit, i.e., the absolute accrual intensity.</p>
<p>If the length of <code>accrualTime</code> equals the length of <code>accrualIntensity - 1</code>
(i.e., the end of accrual is defined), <code>maxNumberOfSubjects</code> is calculated if the absolute accrual intensity is given.
If all elements in <code>accrualIntensity</code> are smaller than 1, <code>accrualIntensity</code> defines
the <em>relative</em> intensity how subjects enter the trial.
For example, <code>accrualIntensity = c(0.1, 0.2)</code> specifies that in the second accrual interval
the intensity is doubled as compared to the first accrual interval. The actual (absolute) accrual intensity
is calculated for the calculated or given <code>maxNumberOfSubjects</code>.
Note that the default is <code>accrualIntensity = 0.1</code> meaning that the <em>absolute</em> accrual intensity
will be calculated.</p>
    </div>
    <div class="section level2">
    <h2 id="simulation-data">Simulation Data<a class="anchor" aria-label="anchor" href="#simulation-data"></a></h2>


<p>The summary statistics "Simulated data" contains the following parameters: median <a href="https://rdrr.io/r/base/range.html" class="external-link">range</a>; mean +/-sd<br></p>
<p><code>$show(showStatistics = FALSE)</code> or <code>$setShowStatistics(FALSE)</code> can be used to disable
the output of the aggregated simulated data.<br></p>
<p>Example 1: <br><code>simulationResults &lt;- getSimulationSurvival(maxNumberOfSubjects = 100, plannedEvents = 30)</code> <br><code>simulationResults$show(showStatistics = FALSE)</code><br></p>
<p>Example 2: <br><code>simulationResults &lt;- getSimulationSurvival(maxNumberOfSubjects = 100, plannedEvents = 30)</code> <br><code>simulationResults$setShowStatistics(FALSE)</code><br><code>simulationResults</code><br></p>
<p><code><a href="getData.html">getData()</a></code> can be used to get the aggregated simulated data from the
object as <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></code>. The data frame contains the following columns:</p><ol><li><p><code>iterationNumber</code>: The number of the simulation iteration.</p></li>
<li><p><code>stageNumber</code>: The stage.</p></li>
<li><p><code>pi1</code>: The assumed or derived event rate in the treatment group.</p></li>
<li><p><code>pi2</code>: The assumed or derived event rate in the control group.</p></li>
<li><p><code>hazardRatio</code>: The hazard ratio under consideration (if available).</p></li>
<li><p><code>analysisTime</code>: The analysis time.</p></li>
<li><p><code>numberOfSubjects</code>: The number of subjects under consideration when the
(interim) analysis takes place.</p></li>
<li><p><code>eventsPerStage1</code>: The observed number of events per stage
in treatment group 1.</p></li>
<li><p><code>eventsPerStage2</code>: The observed number of events per stage
in treatment group 2.</p></li>
<li><p><code>singleEventsPerStage</code>: The observed number of events per stage
in both treatment groups.</p></li>
<li><p><code>rejectPerStage</code>: 1 if null hypothesis can be rejected, 0 otherwise.</p></li>
<li><p><code>futilityPerStage</code>: 1 if study should be stopped for futility, 0 otherwise.</p></li>
<li><p><code>eventsNotAchieved</code>: 1 if number of events could not be reached with
observed number of subjects, 0 otherwise.</p></li>
<li><p><code>testStatistic</code>: The test statistic that is used for the test decision,
depends on which design was chosen (group sequential, inverse normal,
or Fisher combination test)'</p></li>
<li><p><code>logRankStatistic</code>: Z-score statistic which corresponds to a one-sided
log-rank test at considered stage.</p></li>
<li><p><code>hazardRatioEstimateLR</code>: The estimated hazard ratio, derived from the
log-rank statistic.</p></li>
<li><p><code>trialStop</code>: <code>TRUE</code> if study should be stopped for efficacy or futility or final stage, <code>FALSE</code> otherwise.</p></li>
<li><p><code>conditionalPowerAchieved</code>: The conditional power for the subsequent stage of the trial for
selected sample size and effect. The effect is either estimated from the data or can be
user defined with <code>thetaH1</code>.</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="raw-data">Raw Data<a class="anchor" aria-label="anchor" href="#raw-data"></a></h2>


<p><code><a href="getRawData.html">getRawData()</a></code> can be used to get the simulated raw data from the
object as <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></code>. Note that <code>getSimulationSurvival()</code>
must called before with <code>maxNumberOfRawDatasetsPerStage</code> &gt; 0.</p>
    </div>
    <div class="section level2">
    <h2 id="how-to-get-help-for-generic-functions">How to get help for generic functions<a class="anchor" aria-label="anchor" href="#how-to-get-help-for-generic-functions"></a></h2>


<p>Click on the link of a generic in the list above to go directly to the help documentation of
the <code>rpact</code> specific implementation of the generic.
Note that you can use the R function <code><a href="https://rdrr.io/r/utils/methods.html" class="external-link">methods</a></code> to get all the methods of a generic and
to identify the object specific name of it, e.g.,
use <code>methods("plot")</code> to get all the methods for the <code>plot</code> generic.
There you can find, e.g., <code>plot.AnalysisResults</code> and
obtain the specific help documentation linked above by typing <code><a href="plot.AnalysisResults.html">?plot.AnalysisResults</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Fixed sample size with minimum required definitions, pi1 = (0.3,0.4,0.5,0.6) and</span></span></span>
<span class="r-in"><span><span class="co"># pi2 = 0.3 at event time 12, and accrual time 24</span></span></span>
<span class="r-in"><span><span class="fu">getSimulationSurvival</span><span class="op">(</span></span></span>
<span class="r-in"><span>    pi1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.6</span>, <span class="fl">0.1</span><span class="op">)</span>, pi2 <span class="op">=</span> <span class="fl">0.3</span>, eventTime <span class="op">=</span> <span class="fl">12</span>,</span></span>
<span class="r-in"><span>    accrualTime <span class="op">=</span> <span class="fl">24</span>, plannedEvents <span class="op">=</span> <span class="fl">40</span>, maxNumberOfSubjects <span class="op">=</span> <span class="fl">200</span>,</span></span>
<span class="r-in"><span>    maxNumberOfIterations <span class="op">=</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulation of survival data (fixed sample size design):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Design parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Critical values                        : 1.960 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Significance level                     : 0.0250 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Test                                   : one-sided </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> User defined parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Maximum number of iterations           : 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Planned cumulative events              : 40 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Assumed treatment rate                 : 0.300, 0.400, 0.500, 0.600 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Assumed control rate                   : 0.300 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Maximum number of subjects             : 200 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Accrual time                           : 24.00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Default parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Seed                                   : 55430771 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Planned allocation ratio               : 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Conditional power                      : NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Direction upper                        : TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Drop-out rate (1)                      : 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Drop-out rate (2)                      : 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Drop-out time                          : 12.00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Event time                             : 12 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Theta H0                               : 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Allocation 1                           : 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Allocation 2                           : 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   kappa                                  : 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   median(1)                              : 23.3, 16.3, 12.0, 9.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   median(2)                              : 23.3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Accrual intensity                      : 8.3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   lambda(1)                              : 0.0297, 0.0426, 0.0578, 0.0764 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   lambda(2)                              : 0.0297 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Hazard ratio                           : 1.000, 1.432, 1.943, 2.569 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Analysis time                          : 18.92, 17.94, 16.96, 15.81 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Expected study duration                : 18.92, 17.94, 16.96, 15.81 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Events not achieved                    : 0.000, 0.000, 0.000, 0.000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Cumulative number of events            : 40, 40, 40, 40 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Iterations                             : 10, 10, 10, 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Overall reject                         : 0.1000, 0.1000, 0.5000, 1.0000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Reject per stage                       : 0.1000, 0.1000, 0.5000, 1.0000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Early stop                             : 0.0000, 0.0000, 0.0000, 0.0000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Expected number of subjects            : 157.4, 148.9, 140.8, 131.3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Expected number of events              : 40, 40, 40, 40 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Legend:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   (i): values of treatment arm i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Increase number of simulation iterations</span></span></span>
<span class="r-in"><span><span class="fu">getSimulationSurvival</span><span class="op">(</span></span></span>
<span class="r-in"><span>    pi1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.6</span>, <span class="fl">0.1</span><span class="op">)</span>, pi2 <span class="op">=</span> <span class="fl">0.3</span>, eventTime <span class="op">=</span> <span class="fl">12</span>,</span></span>
<span class="r-in"><span>    accrualTime <span class="op">=</span> <span class="fl">24</span>, plannedEvents <span class="op">=</span> <span class="fl">40</span>, maxNumberOfSubjects <span class="op">=</span> <span class="fl">200</span>,</span></span>
<span class="r-in"><span>    maxNumberOfIterations <span class="op">=</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Determine necessary accrual time with default settings if 200 subjects and</span></span></span>
<span class="r-in"><span><span class="co"># 30 subjects per time unit can be recruited</span></span></span>
<span class="r-in"><span><span class="fu">getSimulationSurvival</span><span class="op">(</span></span></span>
<span class="r-in"><span>    plannedEvents <span class="op">=</span> <span class="fl">40</span>, accrualTime <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>    accrualIntensity <span class="op">=</span> <span class="fl">30</span>, maxNumberOfSubjects <span class="op">=</span> <span class="fl">200</span>, maxNumberOfIterations <span class="op">=</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Determine necessary accrual time with default settings if 200 subjects and</span></span></span>
<span class="r-in"><span><span class="co"># if the first 6 time units 20 subjects per time unit can be recruited,</span></span></span>
<span class="r-in"><span><span class="co"># then 30 subjects per time unit</span></span></span>
<span class="r-in"><span><span class="fu">getSimulationSurvival</span><span class="op">(</span></span></span>
<span class="r-in"><span>    plannedEvents <span class="op">=</span> <span class="fl">40</span>, accrualTime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    accrualIntensity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">30</span><span class="op">)</span>, maxNumberOfSubjects <span class="op">=</span> <span class="fl">200</span>,</span></span>
<span class="r-in"><span>    maxNumberOfIterations <span class="op">=</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Determine maximum number of Subjects with default settings if the first</span></span></span>
<span class="r-in"><span><span class="co"># 6 time units 20 subjects per time unit can be recruited, and after</span></span></span>
<span class="r-in"><span><span class="co"># 10 time units 30 subjects per time unit</span></span></span>
<span class="r-in"><span><span class="fu">getSimulationSurvival</span><span class="op">(</span></span></span>
<span class="r-in"><span>    plannedEvents <span class="op">=</span> <span class="fl">40</span>, accrualTime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6</span>, <span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    accrualIntensity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">30</span><span class="op">)</span>, maxNumberOfIterations <span class="op">=</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Specify accrual time as a list</span></span></span>
<span class="r-in"><span><span class="va">at</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"0 - &lt;6"</span>  <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>    <span class="st">"6 - Inf"</span> <span class="op">=</span> <span class="fl">30</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">getSimulationSurvival</span><span class="op">(</span></span></span>
<span class="r-in"><span>    plannedEvents <span class="op">=</span> <span class="fl">40</span>, accrualTime <span class="op">=</span> <span class="va">at</span>,</span></span>
<span class="r-in"><span>    maxNumberOfSubjects <span class="op">=</span> <span class="fl">200</span>, maxNumberOfIterations <span class="op">=</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Specify accrual time as a list, if maximum number of subjects need to be calculated</span></span></span>
<span class="r-in"><span><span class="va">at</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"0 - &lt;6"</span>   <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>    <span class="st">"6 - &lt;=10"</span> <span class="op">=</span> <span class="fl">30</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">getSimulationSurvival</span><span class="op">(</span>plannedEvents <span class="op">=</span> <span class="fl">40</span>, accrualTime <span class="op">=</span> <span class="va">at</span>, maxNumberOfIterations <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Specify effect size for a two-stage group sequential design with</span></span></span>
<span class="r-in"><span><span class="co"># O'Brien &amp; Fleming boundaries. Effect size is based on event rates</span></span></span>
<span class="r-in"><span><span class="co"># at specified event time, directionUpper = FALSE needs to be specified</span></span></span>
<span class="r-in"><span><span class="co"># because it should be shown that hazard ratio &lt; 1</span></span></span>
<span class="r-in"><span><span class="va">designGS</span> <span class="op">&lt;-</span> <span class="fu"><a href="getDesignGroupSequential.html">getDesignGroupSequential</a></span><span class="op">(</span>kMax <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">getSimulationSurvival</span><span class="op">(</span></span></span>
<span class="r-in"><span>    design <span class="op">=</span> <span class="va">designGS</span>,</span></span>
<span class="r-in"><span>    pi1 <span class="op">=</span> <span class="fl">0.2</span>, pi2 <span class="op">=</span> <span class="fl">0.3</span>, eventTime <span class="op">=</span> <span class="fl">24</span>, plannedEvents <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">40</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    maxNumberOfSubjects <span class="op">=</span> <span class="fl">200</span>, directionUpper <span class="op">=</span> <span class="cn">FALSE</span>, maxNumberOfIterations <span class="op">=</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># As above, but with a three-stage O'Brien and Fleming design with</span></span></span>
<span class="r-in"><span><span class="co"># specified information rates, note that planned events consists of integer values</span></span></span>
<span class="r-in"><span><span class="va">designGS2</span> <span class="op">&lt;-</span> <span class="fu"><a href="getDesignGroupSequential.html">getDesignGroupSequential</a></span><span class="op">(</span>informationRates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.7</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">getSimulationSurvival</span><span class="op">(</span></span></span>
<span class="r-in"><span>    design <span class="op">=</span> <span class="va">designGS2</span>, </span></span>
<span class="r-in"><span>    pi1 <span class="op">=</span> <span class="fl">0.2</span>, pi2 <span class="op">=</span> <span class="fl">0.3</span>, eventTime <span class="op">=</span> <span class="fl">24</span>,</span></span>
<span class="r-in"><span>    plannedEvents <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">designGS2</span><span class="op">$</span><span class="va">informationRates</span> <span class="op">*</span> <span class="fl">40</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    maxNumberOfSubjects <span class="op">=</span> <span class="fl">200</span>, directionUpper <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    maxNumberOfIterations <span class="op">=</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Effect size is based on event rate at specified event time for the reference</span></span></span>
<span class="r-in"><span><span class="co"># group and hazard ratio, directionUpper = FALSE needs to be specified because</span></span></span>
<span class="r-in"><span><span class="co"># it should be shown that hazard ratio &lt; 1</span></span></span>
<span class="r-in"><span><span class="fu">getSimulationSurvival</span><span class="op">(</span></span></span>
<span class="r-in"><span>    design <span class="op">=</span> <span class="va">designGS</span>, hazardRatio <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>    pi2 <span class="op">=</span> <span class="fl">0.3</span>, eventTime <span class="op">=</span> <span class="fl">24</span>, plannedEvents <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">40</span><span class="op">)</span>, maxNumberOfSubjects <span class="op">=</span> <span class="fl">200</span>,</span></span>
<span class="r-in"><span>    directionUpper <span class="op">=</span> <span class="cn">FALSE</span>, maxNumberOfIterations <span class="op">=</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Effect size is based on hazard rate for the reference group and</span></span></span>
<span class="r-in"><span><span class="co"># hazard ratio, directionUpper = FALSE needs to be specified because</span></span></span>
<span class="r-in"><span><span class="co"># it should be shown that hazard ratio &lt; 1</span></span></span>
<span class="r-in"><span><span class="fu">getSimulationSurvival</span><span class="op">(</span></span></span>
<span class="r-in"><span>    design <span class="op">=</span> <span class="va">designGS</span>,</span></span>
<span class="r-in"><span>    hazardRatio <span class="op">=</span> <span class="fl">0.5</span>, lambda2 <span class="op">=</span> <span class="fl">0.02</span>, plannedEvents <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">40</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    maxNumberOfSubjects <span class="op">=</span> <span class="fl">200</span>, directionUpper <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    maxNumberOfIterations <span class="op">=</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Specification of piecewise exponential survival time and hazard ratios,</span></span></span>
<span class="r-in"><span><span class="co"># note that in getSimulationSurvival only on hazard ratio is used</span></span></span>
<span class="r-in"><span><span class="co"># in the case that the survival time is piecewise expoential</span></span></span>
<span class="r-in"><span><span class="fu">getSimulationSurvival</span><span class="op">(</span></span></span>
<span class="r-in"><span>    design <span class="op">=</span> <span class="va">designGS</span>,</span></span>
<span class="r-in"><span>    piecewiseSurvivalTime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span>, lambda2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.02</span>, <span class="fl">0.04</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    hazardRatio <span class="op">=</span> <span class="fl">1.5</span>, plannedEvents <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">40</span><span class="op">)</span>, maxNumberOfSubjects <span class="op">=</span> <span class="fl">200</span>,</span></span>
<span class="r-in"><span>    maxNumberOfIterations <span class="op">=</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pws</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"0 - &lt;5"</span>  <span class="op">=</span> <span class="fl">0.01</span>,</span></span>
<span class="r-in"><span>    <span class="st">"5 - &lt;10"</span> <span class="op">=</span> <span class="fl">0.02</span>,</span></span>
<span class="r-in"><span>    <span class="st">"&gt;=10"</span>    <span class="op">=</span> <span class="fl">0.04</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">getSimulationSurvival</span><span class="op">(</span></span></span>
<span class="r-in"><span>    design <span class="op">=</span> <span class="va">designGS</span>,</span></span>
<span class="r-in"><span>    piecewiseSurvivalTime <span class="op">=</span> <span class="va">pws</span>, hazardRatio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    plannedEvents <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">40</span><span class="op">)</span>, maxNumberOfSubjects <span class="op">=</span> <span class="fl">200</span>,</span></span>
<span class="r-in"><span>    maxNumberOfIterations <span class="op">=</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Specification of piecewise exponential survival time for both treatment arms</span></span></span>
<span class="r-in"><span><span class="fu">getSimulationSurvival</span><span class="op">(</span></span></span>
<span class="r-in"><span>    design <span class="op">=</span> <span class="va">designGS</span>,</span></span>
<span class="r-in"><span>    piecewiseSurvivalTime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span>, lambda2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.02</span>, <span class="fl">0.04</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    lambda1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.015</span>, <span class="fl">0.03</span>, <span class="fl">0.06</span><span class="op">)</span>, plannedEvents <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">40</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    maxNumberOfSubjects <span class="op">=</span> <span class="fl">200</span>, maxNumberOfIterations <span class="op">=</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Specification of piecewise exponential survival time as a list,</span></span></span>
<span class="r-in"><span><span class="co"># note that in getSimulationSurvival only on hazard ratio</span></span></span>
<span class="r-in"><span><span class="co"># (not a vector) can be used</span></span></span>
<span class="r-in"><span><span class="va">pws</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"0 - &lt;5"</span>  <span class="op">=</span> <span class="fl">0.01</span>,</span></span>
<span class="r-in"><span>    <span class="st">"5 - &lt;10"</span> <span class="op">=</span> <span class="fl">0.02</span>,</span></span>
<span class="r-in"><span>    <span class="st">"&gt;=10"</span>    <span class="op">=</span> <span class="fl">0.04</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">getSimulationSurvival</span><span class="op">(</span></span></span>
<span class="r-in"><span>    design <span class="op">=</span> <span class="va">designGS</span>,</span></span>
<span class="r-in"><span>    piecewiseSurvivalTime <span class="op">=</span> <span class="va">pws</span>, hazardRatio <span class="op">=</span> <span class="fl">1.5</span>,</span></span>
<span class="r-in"><span>    plannedEvents <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">40</span><span class="op">)</span>, maxNumberOfSubjects <span class="op">=</span> <span class="fl">200</span>,</span></span>
<span class="r-in"><span>    maxNumberOfIterations <span class="op">=</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Specification of piecewise exponential survival time and delayed effect</span></span></span>
<span class="r-in"><span><span class="co"># (response after 5 time units)</span></span></span>
<span class="r-in"><span><span class="fu">getSimulationSurvival</span><span class="op">(</span></span></span>
<span class="r-in"><span>    design <span class="op">=</span> <span class="va">designGS</span>,</span></span>
<span class="r-in"><span>    piecewiseSurvivalTime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span>, lambda2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.02</span>, <span class="fl">0.04</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    lambda1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.02</span>, <span class="fl">0.06</span><span class="op">)</span>, plannedEvents <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">40</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    maxNumberOfSubjects <span class="op">=</span> <span class="fl">200</span>, maxNumberOfIterations <span class="op">=</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Specify effect size based on median survival times</span></span></span>
<span class="r-in"><span><span class="fu">getSimulationSurvival</span><span class="op">(</span></span></span>
<span class="r-in"><span>    median1 <span class="op">=</span> <span class="fl">5</span>, median2 <span class="op">=</span> <span class="fl">3</span>, plannedEvents <span class="op">=</span> <span class="fl">40</span>,</span></span>
<span class="r-in"><span>    maxNumberOfSubjects <span class="op">=</span> <span class="fl">200</span>, directionUpper <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    maxNumberOfIterations <span class="op">=</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Specify effect size based on median survival</span></span></span>
<span class="r-in"><span><span class="co"># times of Weibull distribtion with kappa = 2</span></span></span>
<span class="r-in"><span><span class="fu">getSimulationSurvival</span><span class="op">(</span></span></span>
<span class="r-in"><span>    median1 <span class="op">=</span> <span class="fl">5</span>, median2 <span class="op">=</span> <span class="fl">3</span>, kappa <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>    plannedEvents <span class="op">=</span> <span class="fl">40</span>, maxNumberOfSubjects <span class="op">=</span> <span class="fl">200</span>,</span></span>
<span class="r-in"><span>    directionUpper <span class="op">=</span> <span class="cn">FALSE</span>, maxNumberOfIterations <span class="op">=</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Perform recalculation of number of events based on conditional power for a</span></span></span>
<span class="r-in"><span><span class="co"># three-stage design with inverse normal combination test, where the conditional power</span></span></span>
<span class="r-in"><span><span class="co"># is calculated under the specified effect size thetaH1 = 1.3 and up to a four-fold</span></span></span>
<span class="r-in"><span><span class="co"># increase in originally planned sample size (number of events) is allowed.</span></span></span>
<span class="r-in"><span><span class="co"># Note that the first value in minNumberOfEventsPerStage and</span></span></span>
<span class="r-in"><span><span class="co"># maxNumberOfEventsPerStage is arbitrary, i.e., it has no effect.</span></span></span>
<span class="r-in"><span><span class="va">designIN</span> <span class="op">&lt;-</span> <span class="fu"><a href="getDesignInverseNormal.html">getDesignInverseNormal</a></span><span class="op">(</span>informationRates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.7</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">resultsWithSSR1</span> <span class="op">&lt;-</span> <span class="fu">getSimulationSurvival</span><span class="op">(</span></span></span>
<span class="r-in"><span>    design <span class="op">=</span> <span class="va">designIN</span>,</span></span>
<span class="r-in"><span>    hazardRatio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.6</span>, <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    pi2 <span class="op">=</span> <span class="fl">0.3</span>, conditionalPower <span class="op">=</span> <span class="fl">0.8</span>, thetaH1 <span class="op">=</span> <span class="fl">1.3</span>,</span></span>
<span class="r-in"><span>    plannedEvents <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">58</span>, <span class="fl">102</span>, <span class="fl">146</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    minNumberOfEventsPerStage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">44</span>, <span class="fl">44</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    maxNumberOfEventsPerStage <span class="op">=</span> <span class="fl">4</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">44</span>, <span class="fl">44</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    maxNumberOfSubjects <span class="op">=</span> <span class="fl">800</span>, maxNumberOfIterations <span class="op">=</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">resultsWithSSR1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># If thetaH1 is unspecified, the observed hazard ratio estimate</span></span></span>
<span class="r-in"><span><span class="co"># (calculated from the log-rank statistic) is used for performing the</span></span></span>
<span class="r-in"><span><span class="co"># recalculation of the number of events</span></span></span>
<span class="r-in"><span><span class="va">resultsWithSSR2</span> <span class="op">&lt;-</span> <span class="fu">getSimulationSurvival</span><span class="op">(</span></span></span>
<span class="r-in"><span>    design <span class="op">=</span> <span class="va">designIN</span>,</span></span>
<span class="r-in"><span>    hazardRatio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.6</span>, <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    pi2 <span class="op">=</span> <span class="fl">0.3</span>, conditionalPower <span class="op">=</span> <span class="fl">0.8</span>, plannedEvents <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">58</span>, <span class="fl">102</span>, <span class="fl">146</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    minNumberOfEventsPerStage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">44</span>, <span class="fl">44</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    maxNumberOfEventsPerStage <span class="op">=</span> <span class="fl">4</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">44</span>, <span class="fl">44</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    maxNumberOfSubjects <span class="op">=</span> <span class="fl">800</span>, maxNumberOfIterations <span class="op">=</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">resultsWithSSR2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare it with design without event size recalculation</span></span></span>
<span class="r-in"><span><span class="va">resultsWithoutSSR</span> <span class="op">&lt;-</span> <span class="fu">getSimulationSurvival</span><span class="op">(</span></span></span>
<span class="r-in"><span>    design <span class="op">=</span> <span class="va">designIN</span>,</span></span>
<span class="r-in"><span>    hazardRatio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.6</span>, <span class="fl">0.1</span><span class="op">)</span>, pi2 <span class="op">=</span> <span class="fl">0.3</span>,</span></span>
<span class="r-in"><span>    plannedEvents <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">58</span>, <span class="fl">102</span>, <span class="fl">145</span><span class="op">)</span>, maxNumberOfSubjects <span class="op">=</span> <span class="fl">800</span>,</span></span>
<span class="r-in"><span>    maxNumberOfIterations <span class="op">=</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">resultsWithoutSSR</span><span class="op">$</span><span class="va">overallReject</span></span></span>
<span class="r-in"><span><span class="va">resultsWithSSR1</span><span class="op">$</span><span class="va">overallReject</span></span></span>
<span class="r-in"><span><span class="va">resultsWithSSR2</span><span class="op">$</span><span class="va">overallReject</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Confirm that event size racalcuation increases the Type I error rate,</span></span></span>
<span class="r-in"><span><span class="co"># i.e., you have to use the combination test</span></span></span>
<span class="r-in"><span><span class="va">resultsWithSSRGS</span> <span class="op">&lt;-</span> <span class="fu">getSimulationSurvival</span><span class="op">(</span></span></span>
<span class="r-in"><span>    design <span class="op">=</span> <span class="va">designGS2</span>, </span></span>
<span class="r-in"><span>    hazardRatio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    pi2 <span class="op">=</span> <span class="fl">0.3</span>, conditionalPower <span class="op">=</span> <span class="fl">0.8</span>, plannedEvents <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">58</span>, <span class="fl">102</span>, <span class="fl">145</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    minNumberOfEventsPerStage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">44</span>, <span class="fl">44</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    maxNumberOfEventsPerStage <span class="op">=</span> <span class="fl">4</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">44</span>, <span class="fl">44</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    maxNumberOfSubjects <span class="op">=</span> <span class="fl">800</span>, maxNumberOfIterations <span class="op">=</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">resultsWithSSRGS</span><span class="op">$</span><span class="va">overallReject</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Set seed to get reproducable results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu">getSimulationSurvival</span><span class="op">(</span></span></span>
<span class="r-in"><span>        plannedEvents <span class="op">=</span> <span class="fl">40</span>, maxNumberOfSubjects <span class="op">=</span> <span class="fl">200</span>,</span></span>
<span class="r-in"><span>        seed <span class="op">=</span> <span class="fl">99</span></span></span>
<span class="r-in"><span>    <span class="op">)</span><span class="op">$</span><span class="va">analysisTime</span>,</span></span>
<span class="r-in"><span>    <span class="fu">getSimulationSurvival</span><span class="op">(</span></span></span>
<span class="r-in"><span>        plannedEvents <span class="op">=</span> <span class="fl">40</span>, maxNumberOfSubjects <span class="op">=</span> <span class="fl">200</span>,</span></span>
<span class="r-in"><span>        seed <span class="op">=</span> <span class="fl">99</span></span></span>
<span class="r-in"><span>    <span class="op">)</span><span class="op">$</span><span class="va">analysisTime</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Perform recalculation of number of events based on conditional power as above.</span></span></span>
<span class="r-in"><span><span class="co"># The number of events is recalculated only in the first interim, the recalculated number</span></span></span>
<span class="r-in"><span><span class="co"># is also used for the final stage. Here, we use the user defind calcEventsFunction as</span></span></span>
<span class="r-in"><span><span class="co"># follows (note that the last stage value in minNumberOfEventsPerStage and maxNumberOfEventsPerStage</span></span></span>
<span class="r-in"><span><span class="co"># has no effect):</span></span></span>
<span class="r-in"><span><span class="va">myCalcEventsFunction</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span>,</span></span>
<span class="r-in"><span>        <span class="va">stage</span>, <span class="va">conditionalPower</span>, <span class="va">estimatedTheta</span>,</span></span>
<span class="r-in"><span>        <span class="va">plannedEvents</span>, <span class="va">eventsOverStages</span>,</span></span>
<span class="r-in"><span>        <span class="va">minNumberOfEventsPerStage</span>, <span class="va">maxNumberOfEventsPerStage</span>,</span></span>
<span class="r-in"><span>        <span class="va">conditionalCriticalValue</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">1e-12</span>, <span class="va">estimatedTheta</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="kw">if</span> <span class="op">(</span><span class="va">stage</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>        <span class="va">requiredStageEvents</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>            <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">conditionalCriticalValue</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="va">conditionalPower</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="fl">4</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span></span>
<span class="r-in"><span>        <span class="va">requiredOverallStageEvents</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">minNumberOfEventsPerStage</span><span class="op">[</span><span class="va">stage</span><span class="op">]</span>, <span class="va">requiredStageEvents</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            <span class="va">maxNumberOfEventsPerStage</span><span class="op">[</span><span class="va">stage</span><span class="op">]</span></span></span>
<span class="r-in"><span>        <span class="op">)</span> <span class="op">+</span> <span class="va">eventsOverStages</span><span class="op">[</span><span class="va">stage</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>        <span class="va">requiredOverallStageEvents</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">eventsOverStages</span><span class="op">[</span><span class="va">stage</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">eventsOverStages</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">requiredOverallStageEvents</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">resultsWithSSR</span> <span class="op">&lt;-</span> <span class="fu">getSimulationSurvival</span><span class="op">(</span></span></span>
<span class="r-in"><span>    design <span class="op">=</span> <span class="va">designIN</span>,</span></span>
<span class="r-in"><span>    hazardRatio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2.6</span>, <span class="fl">0.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    pi2 <span class="op">=</span> <span class="fl">0.3</span>,</span></span>
<span class="r-in"><span>    conditionalPower <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>    plannedEvents <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">58</span>, <span class="fl">102</span>, <span class="fl">146</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    minNumberOfEventsPerStage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">44</span>, <span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    maxNumberOfEventsPerStage <span class="op">=</span> <span class="fl">4</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">44</span>, <span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    maxNumberOfSubjects <span class="op">=</span> <span class="fl">800</span>,</span></span>
<span class="r-in"><span>    calcEventsFunction <span class="op">=</span> <span class="va">myCalcEventsFunction</span>,</span></span>
<span class="r-in"><span>    seed <span class="op">=</span> <span class="fl">1234</span>,</span></span>
<span class="r-in"><span>    maxNumberOfIterations <span class="op">=</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gernot Wassmer, Friedrich Pahlke.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

