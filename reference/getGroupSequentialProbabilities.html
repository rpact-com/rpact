<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Get Group Sequential Probabilities — getGroupSequentialProbabilities • rpact</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get Group Sequential Probabilities — getGroupSequentialProbabilities"><meta name="description" content="Calculates probabilities in the group sequential setting."><meta property="og:description" content="Calculates probabilities in the group sequential setting."><meta property="og:image" content="https://docs.rpact.org/logo.png"><meta name="keywords" content="rpact, adaptive designs, clinical trials, simulation, analysis, rstats, Shiny, r-project, R package"><link href="reference/figures/favicon.ico" rel="icon"><link href="reference/figures/favicon.ico" rel="apple-touch-icon"><link href="reference/figures/favicon.ico" rel="shortcut icon" type="image/vnd.microsoft.icon"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rpact</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/rpact_getting_started.html">Getting started with rpact</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rpact-com/rpact/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Get Group Sequential Probabilities</h1>
      <small class="dont-index">Source: <a href="https://github.com/rpact-com/rpact/blob/v4.3.0/R/f_design_group_sequential.R" class="external-link"><code>R/f_design_group_sequential.R</code></a></small>
      <div class="d-none name"><code>getGroupSequentialProbabilities.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates probabilities in the group sequential setting.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">getGroupSequentialProbabilities</span><span class="op">(</span><span class="va">decisionMatrix</span>, <span class="va">informationRates</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-decisionmatrix">decisionMatrix<a class="anchor" aria-label="anchor" href="#arg-decisionmatrix"></a></dt>
<dd><p>A matrix with either 2 or 4 rows and kMax = length(informationRates) columns, see details.</p></dd>


<dt id="arg-informationrates">informationRates<a class="anchor" aria-label="anchor" href="#arg-informationrates"></a></dt>
<dd><p>The information rates t_1, ..., t_kMax (that must be fixed prior to the trial),
default is <code>(1:kMax) / kMax</code>. For the weighted inverse normal design, the weights are derived
through w_1 = sqrt(t_1), and w_k = sqrt(t_k - t_(k-1)). For the weighted Fisher's combination test, the
weights (scales) are w_k = sqrt((t_k - t_(k-1)) / t_1) (see the documentation).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a numeric matrix containing the probabilities described in the details section.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Given a sequence of information rates (fixing the correlation structure), and
decisionMatrix with either 2 or 4 rows and kMax = length(informationRates) columns,
this function calculates a probability matrix containing, for two rows, the probabilities:<br>
P(Z_1 &lt; l_1), P(l_1 &lt; Z_1 &lt; u_1, Z_2 &lt; l_2),..., P(l_kMax-1 &lt; Z_kMax-1 &lt; u_kMax-1, Z_kMax &lt; l_l_kMax)<br>
P(Z_1 &lt; u_1), P(l_1 &lt; Z_1 &lt; u_1, Z_2 &lt; u_2),..., P(l_kMax-1 &lt; Z_kMax-1 &lt; u_kMax-1, Z_kMax &lt; u_l_kMax)<br>
P(Z_1 &lt; Inf), P(l_1 &lt; Z_1 &lt; u_1, Z_2 &lt; Inf),..., P(l_kMax-1 &lt; Z_kMax-1 &lt; u_kMax-1, Z_kMax &lt; Inf)<br>
with continuation matrix<br>
l_1,...,l_kMax<br>
u_1,...,u_kMax<br>
That is, the output matrix of the function provides per stage (column) the cumulative probabilities
for values specified in decisionMatrix and Inf, and reaching the stage, i.e., the test
statistics is in the continuation region for the preceding stages.
For 4 rows, the continuation region contains of two regions and the probability matrix is
obtained analogously (cf., Wassmer and Brannath, 2025).</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other design functions:
<code><a href="getDesignCharacteristics.html">getDesignCharacteristics()</a></code>,
<code><a href="getDesignConditionalDunnett.html">getDesignConditionalDunnett()</a></code>,
<code><a href="getDesignFisher.html">getDesignFisher()</a></code>,
<code><a href="getDesignGroupSequential.html">getDesignGroupSequential()</a></code>,
<code><a href="getDesignInverseNormal.html">getDesignInverseNormal()</a></code>,
<code><a href="getPowerAndAverageSampleNumber.html">getPowerAndAverageSampleNumber()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Calculate Type I error rates in the two-sided group sequential setting when</span></span></span>
<span class="r-in"><span><span class="co"># performing kMax stages with constant critical boundaries at level alpha:</span></span></span>
<span class="r-in"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span></span>
<span class="r-in"><span><span class="va">kMax</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="va">decisionMatrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>, <span class="va">kMax</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>, <span class="va">kMax</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">informationRates</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">kMax</span><span class="op">)</span> <span class="op">/</span> <span class="va">kMax</span></span></span>
<span class="r-in"><span><span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu">getGroupSequentialProbabilities</span><span class="op">(</span><span class="va">decisionMatrix</span>, <span class="va">informationRates</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">probs</span><span class="op">[</span><span class="fl">3</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">probs</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span> <span class="op">+</span> <span class="va">probs</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Do the same for a one-sided design without futility boundaries:</span></span></span>
<span class="r-in"><span><span class="va">decisionMatrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="va">kMax</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span><span class="op">)</span>, <span class="va">kMax</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">informationRates</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">kMax</span><span class="op">)</span> <span class="op">/</span> <span class="va">kMax</span></span></span>
<span class="r-in"><span><span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu">getGroupSequentialProbabilities</span><span class="op">(</span><span class="va">decisionMatrix</span>, <span class="va">informationRates</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">probs</span><span class="op">[</span><span class="fl">3</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">probs</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Check that two-sided Pampallona and Tsiatis boundaries with binding </span></span></span>
<span class="r-in"><span><span class="co"># futility bounds obtain Type I error probabilities equal to alpha:</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="getDesignGroupSequential.html">getDesignGroupSequential</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    alpha <span class="op">=</span> <span class="fl">0.05</span>, beta <span class="op">=</span> <span class="fl">0.1</span>, kMax <span class="op">=</span> <span class="fl">3</span>, typeOfDesign <span class="op">=</span> <span class="st">"PT"</span>,</span></span>
<span class="r-in"><span>    deltaPT0 <span class="op">=</span> <span class="fl">0</span>, deltaPT1 <span class="op">=</span> <span class="fl">0.4</span>, sided <span class="op">=</span> <span class="fl">2</span>, bindingFutility <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="op">-</span><span class="va">x</span><span class="op">$</span><span class="va">criticalValues</span>, <span class="op">-</span><span class="va">x</span><span class="op">$</span><span class="va">futilityBounds</span>, <span class="fl">0</span>,</span></span>
<span class="r-in"><span>    <span class="va">x</span><span class="op">$</span><span class="va">futilityBounds</span>, <span class="fl">0</span>, <span class="va">x</span><span class="op">$</span><span class="va">criticalValues</span></span></span>
<span class="r-in"><span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">4</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dm</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">dm</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span><span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu">getGroupSequentialProbabilities</span><span class="op">(</span></span></span>
<span class="r-in"><span>    decisionMatrix <span class="op">=</span> <span class="va">dm</span>, informationRates <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">/</span> <span class="fl">3</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">probs</span><span class="op">[</span><span class="fl">5</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">probs</span><span class="op">[</span><span class="fl">4</span>, <span class="op">]</span> <span class="op">+</span> <span class="va">probs</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Check the Type I error rate decrease when using non-binding futility bounds:</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="getDesignGroupSequential.html">getDesignGroupSequential</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    alpha <span class="op">=</span> <span class="fl">0.05</span>, beta <span class="op">=</span> <span class="fl">0.1</span>, kMax <span class="op">=</span> <span class="fl">3</span>, typeOfDesign <span class="op">=</span> <span class="st">"PT"</span>,</span></span>
<span class="r-in"><span>    deltaPT0 <span class="op">=</span> <span class="fl">0</span>, deltaPT1 <span class="op">=</span> <span class="fl">0.4</span>, sided <span class="op">=</span> <span class="fl">2</span>, bindingFutility <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="op">-</span><span class="va">x</span><span class="op">$</span><span class="va">criticalValues</span>, <span class="op">-</span><span class="va">x</span><span class="op">$</span><span class="va">futilityBounds</span>, <span class="fl">0</span>,</span></span>
<span class="r-in"><span>    <span class="va">x</span><span class="op">$</span><span class="va">futilityBounds</span>, <span class="fl">0</span>, <span class="va">x</span><span class="op">$</span><span class="va">criticalValues</span></span></span>
<span class="r-in"><span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">4</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dm</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">dm</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span><span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu">getGroupSequentialProbabilities</span><span class="op">(</span></span></span>
<span class="r-in"><span>    decisionMatrix <span class="op">=</span> <span class="va">dm</span>, informationRates <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">/</span> <span class="fl">3</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">probs</span><span class="op">[</span><span class="fl">5</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">probs</span><span class="op">[</span><span class="fl">4</span>, <span class="op">]</span> <span class="op">+</span> <span class="va">probs</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gernot Wassmer, Friedrich Pahlke.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

