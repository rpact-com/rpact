<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Get Simulation Rates — getSimulationRates • rpact</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get Simulation Rates — getSimulationRates"><meta name="description" content="Returns the simulated power, stopping probabilities, conditional power, and expected sample size for
testing rates in a one or two treatment groups testing situation."><meta property="og:description" content="Returns the simulated power, stopping probabilities, conditional power, and expected sample size for
testing rates in a one or two treatment groups testing situation."><meta property="og:image" content="https://rpact-com.github.io/rpact/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rpact</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.0.1.9252</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/rpact_getting_started.html">Getting started with rpact</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rpact-com/rpact/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Get Simulation Rates</h1>
      <small class="dont-index">Source: <a href="https://github.com/rpact-com/rpact/blob/main/R/f_simulation_base_rates.R" class="external-link"><code>R/f_simulation_base_rates.R</code></a></small>
      <div class="d-none name"><code>getSimulationRates.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Returns the simulated power, stopping probabilities, conditional power, and expected sample size for
testing rates in a one or two treatment groups testing situation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">getSimulationRates</span><span class="op">(</span></span>
<span>  design <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  groups <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>  normalApproximation <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  riskRatio <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  thetaH0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">riskRatio</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  pi1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  pi2 <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  plannedSubjects <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  directionUpper <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  allocationRatioPlanned <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  minNumberOfSubjectsPerStage <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  maxNumberOfSubjectsPerStage <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  conditionalPower <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  pi1H1 <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  pi2H1 <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  maxNumberOfIterations <span class="op">=</span> <span class="fl">1000L</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  calcSubjectsFunction <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  showStatistics <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-design">design<a class="anchor" aria-label="anchor" href="#arg-design"></a></dt>
<dd><p>The trial design. If no trial design is specified, a fixed sample size design is used.
In this case, Type I error rate <code>alpha</code>, Type II error rate <code>beta</code>, <code>twoSidedPower</code>,
and <code>sided</code> can be directly entered as argument where necessary.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Ensures that all arguments (starting from the "...") are to be named and
that a warning will be displayed if unknown arguments are passed.</p></dd>


<dt id="arg-groups">groups<a class="anchor" aria-label="anchor" href="#arg-groups"></a></dt>
<dd><p>The number of treatment groups (1 or 2), default is <code>2</code>.</p></dd>


<dt id="arg-normalapproximation">normalApproximation<a class="anchor" aria-label="anchor" href="#arg-normalapproximation"></a></dt>
<dd><p>The type of computation of the p-values. Default is <code>FALSE</code> for
testing means (i.e., the t test is used) and <code>TRUE</code> for testing rates and the hazard ratio.
For testing rates, if <code>normalApproximation = FALSE</code> is specified, the binomial test
(one sample) or the exact test of Fisher (two samples) is used for calculating the p-values.
In the survival setting <code>normalApproximation = FALSE</code> has no effect.</p></dd>


<dt id="arg-riskratio">riskRatio<a class="anchor" aria-label="anchor" href="#arg-riskratio"></a></dt>
<dd><p>If <code>TRUE</code>, the design characteristics for
one-sided testing of H0: <code>pi1 / pi2 = thetaH0</code> are simulated, default is <code>FALSE</code>.</p></dd>


<dt id="arg-thetah-">thetaH0<a class="anchor" aria-label="anchor" href="#arg-thetah-"></a></dt>
<dd><p>The null hypothesis value,
default is <code>0</code> for the normal and the binary case (testing means and rates, respectively),
it is <code>1</code> for the survival case (testing the hazard ratio).<br><br>
For non-inferiority designs, <code>thetaH0</code> is the non-inferiority bound.
That is, in case of (one-sided) testing of</p><ul><li><p><em>means</em>: a value <code>!= 0</code>
(or a value <code>!= 1</code> for testing the mean ratio) can be specified.</p></li>
<li><p><em>rates</em>: a value <code>!= 0</code>
(or a value <code>!= 1</code> for testing the risk ratio <code>pi1 / pi2</code>) can be specified.</p></li>
<li><p><em>survival data</em>: a bound for testing H0: <code>hazard ratio = thetaH0 != 1</code> can be specified.</p></li>
<li><p><em>count data</em>: a bound for testing H0: <code>lambda1 / lambda2 = thetaH0 != 1</code> can be specified.</p></li>
</ul><p>For testing a rate in one sample, a value <code>thetaH0</code> in (0, 1) has to be specified for
defining the null hypothesis H0: <code>pi = thetaH0</code>.</p></dd>


<dt id="arg-pi-">pi1<a class="anchor" aria-label="anchor" href="#arg-pi-"></a></dt>
<dd><p>A numeric value or vector that represents the assumed probability in
the active treatment group if two treatment groups
are considered, or the alternative probability for a one treatment group design,
default is <code>seq(0.2, 0.5, 0.1)</code> (power calculations and simulations) or
<code>seq(0.4, 0.6, 0.1)</code> (sample size calculations).</p></dd>


<dt id="arg-pi-">pi2<a class="anchor" aria-label="anchor" href="#arg-pi-"></a></dt>
<dd><p>A numeric value that represents the assumed probability in the reference group if two treatment
groups are considered, default is <code>0.2</code>.</p></dd>


<dt id="arg-plannedsubjects">plannedSubjects<a class="anchor" aria-label="anchor" href="#arg-plannedsubjects"></a></dt>
<dd><p><code>plannedSubjects</code> is a numeric vector of length <code>kMax</code> (the number of stages of the design)
that determines the number of cumulated (overall) subjects when the interim stages are planned.
For two treatment arms, it is the number of subjects for both treatment arms.
For multi-arm designs, <code>plannedSubjects</code> refers to the number of subjects per selected active arm.</p></dd>


<dt id="arg-directionupper">directionUpper<a class="anchor" aria-label="anchor" href="#arg-directionupper"></a></dt>
<dd><p>Logical. Specifies the direction of the alternative,
only applicable for one-sided testing; default is <code>TRUE</code>
which means that larger values of the test statistics yield smaller p-values.</p></dd>


<dt id="arg-allocationratioplanned">allocationRatioPlanned<a class="anchor" aria-label="anchor" href="#arg-allocationratioplanned"></a></dt>
<dd><p>The planned allocation ratio <code>n1 / n2</code> for a two treatment groups
design, default is <code>1</code>. For multi-arm designs, it is the allocation ratio relating the active arm(s) to the control.
For simulating means and rates for a two treatment groups design, it can be a vector of length <code>kMax</code>, the number of stages.
It can be a vector of length kMax, too, for multi-arm and enrichment designs.
In these cases, a change of allocating subjects to treatment groups over the stages can be assessed.
Note that internally <code>allocationRatioPlanned</code> is treated as a vector of length <code>kMax</code>, not a scalar.</p></dd>


<dt id="arg-minnumberofsubjectsperstage">minNumberOfSubjectsPerStage<a class="anchor" aria-label="anchor" href="#arg-minnumberofsubjectsperstage"></a></dt>
<dd><p>When performing a data driven sample size recalculation,
the numeric vector <code>minNumberOfSubjectsPerStage</code> with length <code>kMax</code> determines the
minimum number of subjects per stage (i.e., not cumulated), the first element
is not taken into account. For two treatment arms, it is the number of subjects for both treatment arms.
For multi-arm designs <code>minNumberOfSubjectsPerStage</code> refers
to the minimum number of subjects per selected active arm.</p></dd>


<dt id="arg-maxnumberofsubjectsperstage">maxNumberOfSubjectsPerStage<a class="anchor" aria-label="anchor" href="#arg-maxnumberofsubjectsperstage"></a></dt>
<dd><p>When performing a data driven sample size recalculation,
the numeric vector <code>maxNumberOfSubjectsPerStage</code> with length <code>kMax</code> determines the maximum number
of subjects per stage (i.e., not cumulated), the first element is not taken into account.
For two treatment arms, it is the number of subjects for both treatment arms.
For multi-arm designs <code>maxNumberOfSubjectsPerStage</code> refers
to the maximum number of subjects per selected active arm.</p></dd>


<dt id="arg-conditionalpower">conditionalPower<a class="anchor" aria-label="anchor" href="#arg-conditionalpower"></a></dt>
<dd><p>If <code>conditionalPower</code> together with <code>minNumberOfSubjectsPerStage</code> and
<code>maxNumberOfSubjectsPerStage</code> (or <code>minNumberOfEventsPerStage</code> and <code>maxNumberOfEventsPerStage</code>
for survival designs) is specified, a sample size recalculation based on the specified conditional power is performed.
It is defined as the power for the subsequent stage given the current data. By default,
the conditional power will be calculated under the observed effect size. Optionally, you can also specify <code>thetaH1</code> and
<code>stDevH1</code> (for simulating means), <code>pi1H1</code> and <code>pi2H1</code> (for simulating rates), or <code>thetaH1</code> (for simulating
hazard ratios) as parameters under which it is calculated and the sample size recalculation is performed.</p></dd>


<dt id="arg-pi-h-">pi1H1<a class="anchor" aria-label="anchor" href="#arg-pi-h-"></a></dt>
<dd><p>If specified, the assumed probability in the active treatment group if two treatment groups
are considered, or the assumed probability for a one treatment group design, for which the conditional
power was calculated.</p></dd>


<dt id="arg-pi-h-">pi2H1<a class="anchor" aria-label="anchor" href="#arg-pi-h-"></a></dt>
<dd><p>If specified, the assumed probability in the reference group if two treatment groups
are considered, for which the conditional power was calculated.</p></dd>


<dt id="arg-maxnumberofiterations">maxNumberOfIterations<a class="anchor" aria-label="anchor" href="#arg-maxnumberofiterations"></a></dt>
<dd><p>The number of simulation iterations, default is <code>1000</code>. Must be a positive integer of length 1.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>The seed to reproduce the simulation, default is a random seed.</p></dd>


<dt id="arg-calcsubjectsfunction">calcSubjectsFunction<a class="anchor" aria-label="anchor" href="#arg-calcsubjectsfunction"></a></dt>
<dd><p>Optionally, a function can be entered that defines the way of performing the sample size
recalculation. By default, sample size recalculation is performed with conditional power and specified
<code>minNumberOfSubjectsPerStage</code> and <code>maxNumberOfSubjectsPerStage</code> (see details and examples).</p></dd>


<dt id="arg-showstatistics">showStatistics<a class="anchor" aria-label="anchor" href="#arg-showstatistics"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, summary statistics of the simulated data
are displayed for the <code>print</code> command, otherwise the output is suppressed, default
is <code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a <code><a href="SimulationResults.html">SimulationResults</a></code> object.
The following generics (R generic functions) are available for this object:</p><ul><li><p><code><a href="names.FieldSet.html">names()</a></code> to obtain the field names,</p></li>
<li><p><code><a href="print.FieldSet.html">print()</a></code> to print the object,</p></li>
<li><p><code><a href="summary.ParameterSet.html">summary()</a></code> to display a summary of the object,</p></li>
<li><p><code><a href="plot.SimulationResults.html">plot()</a></code> to plot the object,</p></li>
<li><p><code><a href="as.data.frame.ParameterSet.html">as.data.frame()</a></code> to coerce the object to a <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></code>,</p></li>
<li><p><code><a href="as.matrix.FieldSet.html">as.matrix()</a></code> to coerce the object to a <code><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>At given design the function simulates the power, stopping probabilities, conditional power, and expected
sample size at given number of subjects and parameter configuration.
Additionally, an allocation ratio = n1/n2 can be specified where n1 and n2 are the number
of subjects in the two treatment groups.</p>
<p>The definition of <code>pi1H1</code> and/or <code>pi2H1</code> makes only sense if <code>kMax</code> &gt; 1
and if <code>conditionalPower</code>, <code>minNumberOfSubjectsPerStage</code>, and
<code>maxNumberOfSubjectsPerStage</code> (or <code>calcSubjectsFunction</code>) are defined.</p>
<p><code>calcSubjectsFunction</code><br>
This function returns the number of subjects at given conditional power and conditional critical value for specified
testing situation. The function might depend on variables
<code>stage</code>,
<code>riskRatio</code>,
<code>thetaH0</code>,
<code>groups</code>,
<code>plannedSubjects</code>,
<code>sampleSizesPerStage</code>,
<code>directionUpper</code>,
<code>allocationRatioPlanned</code>,
<code>minNumberOfSubjectsPerStage</code>,
<code>maxNumberOfSubjectsPerStage</code>,
<code>conditionalPower</code>,
<code>conditionalCriticalValue</code>,
<code>overallRate</code>,
<code>farringtonManningValue1</code>, and <code>farringtonManningValue2</code>.
The function has to contain the three-dots argument '...' (see examples).</p>
    </div>
    <div class="section level2">
    <h2 id="simulation-data">Simulation Data<a class="anchor" aria-label="anchor" href="#simulation-data"></a></h2>


<p>The summary statistics "Simulated data" contains the following parameters: median <a href="https://rdrr.io/r/base/range.html" class="external-link">range</a>; mean +/-sd<br></p>
<p><code>$show(showStatistics = FALSE)</code> or <code>$setShowStatistics(FALSE)</code> can be used to disable
the output of the aggregated simulated data.<br></p>
<p>Example 1: <br><code>simulationResults &lt;- getSimulationRates(plannedSubjects = 40)</code> <br><code>simulationResults$show(showStatistics = FALSE)</code><br></p>
<p>Example 2: <br><code>simulationResults &lt;- getSimulationRates(plannedSubjects = 40)</code> <br><code>simulationResults$setShowStatistics(FALSE)</code><br><code>simulationResults</code><br></p>
<p><code><a href="getData.html">getData()</a></code> can be used to get the aggregated simulated data from the
object as <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></code>. The data frame contains the following columns:</p><ol><li><p><code>iterationNumber</code>: The number of the simulation iteration.</p></li>
<li><p><code>stageNumber</code>: The stage.</p></li>
<li><p><code>pi1</code>: The assumed or derived event rate in the treatment group (if available).</p></li>
<li><p><code>pi2</code>: The assumed or derived event rate in the control group (if available).</p></li>
<li><p><code>numberOfSubjects</code>: The number of subjects under consideration when the
(interim) analysis takes place.</p></li>
<li><p><code>rejectPerStage</code>: 1 if null hypothesis can be rejected, 0 otherwise.</p></li>
<li><p><code>futilityPerStage</code>: 1 if study should be stopped for futility, 0 otherwise.</p></li>
<li><p><code>testStatistic</code>: The test statistic that is used for the test decision,
depends on which design was chosen (group sequential, inverse normal,
or Fisher combination test)'</p></li>
<li><p><code>testStatisticsPerStage</code>: The test statistic for each stage if only data from
the considered stage is taken into account.</p></li>
<li><p><code>overallRate1</code>: The cumulative rate in treatment group 1.</p></li>
<li><p><code>overallRate2</code>: The cumulative rate in treatment group 2.</p></li>
<li><p><code>stagewiseRates1</code>: The stage-wise rate in treatment group 1.</p></li>
<li><p><code>stagewiseRates2</code>: The stage-wise rate in treatment group 2.</p></li>
<li><p><code>sampleSizesPerStage1</code>: The stage-wise sample size in treatment group 1.</p></li>
<li><p><code>sampleSizesPerStage2</code>: The stage-wise sample size in treatment group 2.</p></li>
<li><p><code>trialStop</code>: <code>TRUE</code> if study should be stopped for efficacy or futility or final stage, <code>FALSE</code> otherwise.</p></li>
<li><p><code>conditionalPowerAchieved</code>: The conditional power for the subsequent stage of the trial for
selected sample size and effect. The effect is either estimated from the data or can be
user defined with <code>pi1H1</code> and <code>pi2H1</code>.</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="how-to-get-help-for-generic-functions">How to get help for generic functions<a class="anchor" aria-label="anchor" href="#how-to-get-help-for-generic-functions"></a></h2>


<p>Click on the link of a generic in the list above to go directly to the help documentation of
the <code>rpact</code> specific implementation of the generic.
Note that you can use the R function <code><a href="https://rdrr.io/r/utils/methods.html" class="external-link">methods</a></code> to get all the methods of a generic and
to identify the object specific name of it, e.g.,
use <code>methods("plot")</code> to get all the methods for the <code>plot</code> generic.
There you can find, e.g., <code>plot.AnalysisResults</code> and
obtain the specific help documentation linked above by typing <code><a href="plot.AnalysisResults.html">?plot.AnalysisResults</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Fixed sample size design (two groups) with total sample </span></span></span>
<span class="r-in"><span><span class="co"># size 120, pi1 = (0.3,0.4,0.5,0.6) and pi2 = 0.3</span></span></span>
<span class="r-in"><span><span class="fu">getSimulationRates</span><span class="op">(</span>pi1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.6</span>, <span class="fl">0.1</span><span class="op">)</span>, pi2 <span class="op">=</span> <span class="fl">0.3</span>, </span></span>
<span class="r-in"><span>    plannedSubjects <span class="op">=</span> <span class="fl">120</span>, maxNumberOfIterations <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Increase number of simulation iterations and compare results with power calculator</span></span></span>
<span class="r-in"><span><span class="fu">getSimulationRates</span><span class="op">(</span>pi1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.6</span>, <span class="fl">0.1</span><span class="op">)</span>, pi2 <span class="op">=</span> <span class="fl">0.3</span>, </span></span>
<span class="r-in"><span>    plannedSubjects <span class="op">=</span> <span class="fl">120</span>, maxNumberOfIterations <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="getPowerRates.html">getPowerRates</a></span><span class="op">(</span>pi1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.6</span>, <span class="fl">0.1</span><span class="op">)</span>, pi2 <span class="op">=</span> <span class="fl">0.3</span>, maxNumberOfSubjects <span class="op">=</span> <span class="fl">120</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Do the same for a two-stage Pocock inverse normal group sequential </span></span></span>
<span class="r-in"><span><span class="co"># design with non-binding futility stops</span></span></span>
<span class="r-in"><span><span class="va">designIN</span> <span class="op">&lt;-</span> <span class="fu"><a href="getDesignInverseNormal.html">getDesignInverseNormal</a></span><span class="op">(</span>typeOfDesign <span class="op">=</span> <span class="st">"P"</span>, futilityBounds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">getSimulationRates</span><span class="op">(</span><span class="va">designIN</span>, pi1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.6</span>, <span class="fl">0.1</span><span class="op">)</span>, pi2 <span class="op">=</span> <span class="fl">0.3</span>, </span></span>
<span class="r-in"><span>    plannedSubjects <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">80</span><span class="op">)</span>, maxNumberOfIterations <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="getPowerRates.html">getPowerRates</a></span><span class="op">(</span><span class="va">designIN</span>, pi1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.6</span>, <span class="fl">0.1</span><span class="op">)</span>, pi2 <span class="op">=</span> <span class="fl">0.3</span>, maxNumberOfSubjects <span class="op">=</span> <span class="fl">80</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Assess power and average sample size if a sample size reassessment is </span></span></span>
<span class="r-in"><span><span class="co"># foreseen at conditional power 80% for the subsequent stage (decrease and increase) </span></span></span>
<span class="r-in"><span><span class="co"># based on observed overall (cumulative) rates and specified minNumberOfSubjectsPerStage </span></span></span>
<span class="r-in"><span><span class="co"># and maxNumberOfSubjectsPerStage</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Do the same under the assumption that a sample size increase only takes place </span></span></span>
<span class="r-in"><span><span class="co"># if the rate difference exceeds the value 0.1 at interim. For this, the sample </span></span></span>
<span class="r-in"><span><span class="co"># size recalculation method needs to be redefined:  </span></span></span>
<span class="r-in"><span><span class="va">mySampleSizeCalculationFunction</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span>, <span class="va">stage</span>,</span></span>
<span class="r-in"><span>        <span class="va">plannedSubjects</span>,</span></span>
<span class="r-in"><span>        <span class="va">minNumberOfSubjectsPerStage</span>,</span></span>
<span class="r-in"><span>        <span class="va">maxNumberOfSubjectsPerStage</span>,</span></span>
<span class="r-in"><span>        <span class="va">conditionalPower</span>,</span></span>
<span class="r-in"><span>        <span class="va">conditionalCriticalValue</span>,</span></span>
<span class="r-in"><span>        <span class="va">overallRate</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="kw">if</span> <span class="op">(</span><span class="va">overallRate</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">overallRate</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">plannedSubjects</span><span class="op">[</span><span class="va">stage</span><span class="op">]</span> <span class="op">-</span> <span class="va">plannedSubjects</span><span class="op">[</span><span class="va">stage</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span> </span></span>
<span class="r-in"><span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>        <span class="va">rateUnderH0</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">overallRate</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">overallRate</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span> </span></span>
<span class="r-in"><span>        <span class="va">stageSubjects</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">conditionalCriticalValue</span> <span class="op">*</span> </span></span>
<span class="r-in"><span>            <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">rateUnderH0</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">rateUnderH0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span></span>
<span class="r-in"><span>            <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="va">conditionalPower</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">overallRate</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> </span></span>
<span class="r-in"><span>            <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">overallRate</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="va">overallRate</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">overallRate</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span></span></span>
<span class="r-in"><span>            <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">1e-12</span>, <span class="op">(</span><span class="va">overallRate</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">overallRate</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span></span>
<span class="r-in"><span>        <span class="va">stageSubjects</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>            <span class="va">minNumberOfSubjectsPerStage</span><span class="op">[</span><span class="va">stage</span><span class="op">]</span>, </span></span>
<span class="r-in"><span>            <span class="va">stageSubjects</span><span class="op">)</span>, <span class="va">maxNumberOfSubjectsPerStage</span><span class="op">[</span><span class="va">stage</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">stageSubjects</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu">getSimulationRates</span><span class="op">(</span><span class="va">designIN</span>, pi1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.6</span>, <span class="fl">0.1</span><span class="op">)</span>, pi2 <span class="op">=</span> <span class="fl">0.3</span>, </span></span>
<span class="r-in"><span>    plannedSubjects <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">80</span><span class="op">)</span>, minNumberOfSubjectsPerStage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">20</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>    maxNumberOfSubjectsPerStage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">160</span><span class="op">)</span>, conditionalPower <span class="op">=</span> <span class="fl">0.8</span>, </span></span>
<span class="r-in"><span>    calcSubjectsFunction <span class="op">=</span> <span class="va">mySampleSizeCalculationFunction</span>, maxNumberOfIterations <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gernot Wassmer, Friedrich Pahlke.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

